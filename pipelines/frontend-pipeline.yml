trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - checkout: self
  - task: Npm@1
    inputs:
      command: 'install'
  - script: |
      npm run build
    displayName: 'Build Frontend'
  - task: Docker@2
    inputs:
      command: 'buildAndPush'
      containerRegistry: 'YourAzureContainerRegistryServiceConnection'
      repository: 'frontend-app'
      Dockerfile: 'Dockerfile'
      tags: '$(Build.BuildId)'
  - task: Kubernetes@1
    inputs:
      connectionType: 'Kubernetes Service Connection'
      namespace: 'default'
      command: 'apply'
      useConfigurationFile: true
      configuration: 'k8s/frontend-deployment.yml'
